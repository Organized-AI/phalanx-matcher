# /schema-architect

Generate and validate SQL schemas for Supabase.

## Usage

```
/schema-architect <action> [options]
```

## Actions

### generate
Create SQL migration from specification.

```
/schema-architect generate founders
/schema-architect generate funders  
/schema-architect generate matches
/schema-architect generate all
```

### validate
Check existing schema matches spec.

```
/schema-architect validate
```

### migrate
Generate migration diff from current to target.

```
/schema-architect migrate
```

## Output Location

```
scripts/migrations/
├── 001_create_founders.sql
├── 002_create_funders.sql
├── 003_create_matches.sql
└── 004_create_functions.sql
```

## Schema Spec Reference

Read from `SPECIFICATIONS/database-schema.md` or `PLANNING/EXECUTION-PLAN.md`.

## Generation Rules

1. Always include `created_at` and `updated_at` timestamps
2. Use UUID for primary keys (`gen_random_uuid()`)
3. Add appropriate indexes for query patterns
4. Include RLS policies
5. Add comments for complex columns
6. Vector columns use `vector(1536)` for OpenAI ada-002

## Example Output

```sql
-- 001_create_founders.sql
-- Generated by schema-architect

CREATE TABLE IF NOT EXISTS founders (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name TEXT NOT NULL,
    -- ... rest of schema
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Indexes
CREATE INDEX IF NOT EXISTS founders_industry_idx ON founders(industry_sector);
CREATE INDEX IF NOT EXISTS founders_stage_idx ON founders(company_stage);

-- RLS
ALTER TABLE founders ENABLE ROW LEVEL SECURITY;
```
